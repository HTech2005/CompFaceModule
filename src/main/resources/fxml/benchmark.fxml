<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.BarChart?>
<?import javafx.scene.chart.CategoryAxis?>
<?import javafx.scene.chart.NumberAxis?>

<VBox xmlns:fx="http://javafx.com/fxml" fx:controller="tech.HTECH.ui.BenchmarkController" spacing="20" style="-fx-background-color: #121212;">
    <padding>
        <Insets top="20" right="20" bottom="20" left="20"/>
    </padding>

    <HBox alignment="CENTER_LEFT" spacing="20">
        <Label text="Laboratoire de Tests Scientifiques" style="-fx-text-fill: white; -fx-font-size: 26; -fx-font-weight: bold;"/>
        <Region HBox.hgrow="ALWAYS" />
        <Button text="Lancer une Analyse 1:N" onAction="#handleRunBenchmark" style="-fx-background-color: #6200ee; -fx-text-fill: white; -fx-font-weight: bold; -fx-padding: 10 20; -fx-background-radius: 5;"/>
        <Button text="Exporter CSV" onAction="#handleExportCSV" style="-fx-background-color: #03dac6; -fx-text-fill: black; -fx-font-weight: bold; -fx-padding: 10 20; -fx-background-radius: 5;"/>
    </HBox>

    <!-- Cartes de Statistiques -->
    <HBox spacing="20">
        <VBox spacing="10" HBox.hgrow="ALWAYS" style="-fx-background-color: #1e1e1e; -fx-padding: 20; -fx-background-radius: 10; -fx-border-color: #333333; -fx-border-radius: 10;">
            <Label text="Total Comparaisons" style="-fx-text-fill: #aaaaaa; -fx-font-size: 14;"/>
            <Label fx:id="lblTotal" text="0" style="-fx-text-fill: white; -fx-font-size: 32; -fx-font-weight: bold;"/>
        </VBox>
        <VBox spacing="10" HBox.hgrow="ALWAYS" style="-fx-background-color: #1e1e1e; -fx-padding: 20; -fx-background-radius: 10; -fx-border-color: #333333; -fx-border-radius: 10;">
            <Label text="Taux de Faux Positifs (FAR)" style="-fx-text-fill: #aaaaaa; -fx-font-size: 14;"/>
            <Label fx:id="lblFAR" text="0.00%" style="-fx-text-fill: #ff4e4e; -fx-font-size: 32; -fx-font-weight: bold;"/>
        </VBox>
        <VBox spacing="10" HBox.hgrow="ALWAYS" style="-fx-background-color: #1e1e1e; -fx-padding: 20; -fx-background-radius: 10; -fx-border-color: #333333; -fx-border-radius: 10;">
            <Label text="Taux de Faux Négatifs (FRR)" style="-fx-text-fill: #aaaaaa; -fx-font-size: 14;"/>
            <Label fx:id="lblFRR" text="0.00%" style="-fx-text-fill: #ff9900; -fx-font-size: 32; -fx-font-weight: bold;"/>
        </VBox>
    </HBox>

    <VBox spacing="10" VBox.vgrow="ALWAYS">
        <!-- Table de données -->
        <VBox spacing="10" VBox.vgrow="ALWAYS">
            <Label text="Détails des Comparaisons" style="-fx-text-fill: #00ff88; -fx-font-size: 18; -fx-font-weight: bold;"/>
            <TableView fx:id="tableResults" prefHeight="300" VBox.vgrow="ALWAYS" style="-fx-background-color: #1a1a1a; -fx-control-inner-background: #1a1a1a;">
                <columns>
                    <TableColumn fx:id="colImgA" text="Image A" prefWidth="150"/>
                    <TableColumn fx:id="colImgB" text="Image B" prefWidth="150"/>
                    <TableColumn fx:id="colChi2" text="Chi-2 (%)" prefWidth="100"/>
                    <TableColumn fx:id="colEucl" text="Euclidien (%)" prefWidth="120"/>
                    <TableColumn fx:id="colCos" text="Cosinus (%)" prefWidth="120"/>
                    <TableColumn fx:id="colGlobal" text="Global (%)" prefWidth="100"/>
                    <TableColumn fx:id="colDecision" text="Décision" prefWidth="120"/>
                    <TableColumn fx:id="colStatus" text="Statut Scientifique" prefWidth="200"/>
                </columns>
            </TableView>
        </VBox>

        <!-- Zone Graphique en bas -->
        <HBox spacing="20" prefHeight="250">
            <VBox spacing="10" HBox.hgrow="ALWAYS">
                <Label text="Distribution des Statuts Scientifiques" style="-fx-text-fill: #00ff88; -fx-font-size: 18; -fx-font-weight: bold;"/>
                <BarChart fx:id="barChart" style="-fx-background-color: #1a1a1a; -fx-background-radius: 10; -fx-padding: 5;" legendVisible="false">
                    <xAxis>
                        <CategoryAxis side="BOTTOM" tickLabelFill="WHITE"/>
                    </xAxis>
                    <yAxis>
                        <NumberAxis side="LEFT" tickLabelFill="WHITE"/>
                    </yAxis>
                </BarChart>
            </VBox>
            
            <VBox spacing="10" prefWidth="250" alignment="CENTER_LEFT" style="-fx-background-color: #1a1a1a; -fx-padding: 20; -fx-background-radius: 10; -fx-border-color: #333333; -fx-border-radius: 10;">
                <Label text="Légende Scientifique" style="-fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 14;"/>
                <Separator style="-fx-background-color: #444444;"/>
                <Label text="VP : Vrai Positif (Match correct)" style="-fx-text-fill: #00ff88; -fx-font-size: 12;"/>
                <Label text="VN : Vrai Négatif (Rejet correct)" style="-fx-text-fill: #aaaaaa; -fx-font-size: 12;"/>
                <Label text="FP : Faux Positif (Fausse Alarme)" style="-fx-text-fill: #ff4e4e; -fx-font-size: 12;"/>
                <Label text="FN : Faux Négatif (Oubli)" style="-fx-text-fill: #ff9900; -fx-font-size: 12;"/>
            </VBox>
        </HBox>
    </VBox>
</VBox>
